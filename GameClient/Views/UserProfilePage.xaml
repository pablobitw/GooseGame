<Page x:Class="GameClient.Views.UserProfilePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:props="clr-namespace:GameClient.Resources"
      xmlns:components="clr-namespace:GameClient.Views.Components"
      xmlns:fa="http://schemas.fontawesome.io/icons/"
      mc:Ignorable="d" 
      d:DesignHeight="1080" d:DesignWidth="1920"
      Title="UserProfilePage"
      FontFamily="Segoe UI">

    <Grid Cursor="Arrow">
        <Grid.Background>
            <ImageBrush ImageSource="/Assets/fondo2.png" Stretch="UniformToFill" Opacity="1"/>
        </Grid.Background>

        <Border Style="{StaticResource LobbyContainerBorderStyle}" Width="1400" Height="800">
            <Grid Margin="40">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="400"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button x:Name="BackButton"
                        Grid.Row="0" Grid.Column="0"
                        Content="{x:Static props:Strings.BackButton}"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Width="120" Height="50"
                        FontSize="20" FontWeight="Bold"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Margin="0,0,0,20"
                        Click="BackButton_Click"/>

                <StackPanel Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Border Width="300" Height="300" CornerRadius="150" BorderThickness="0" Margin="0,0,0,30">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="20" ShadowDepth="5" Opacity="0.3"/>
                        </Border.Effect>
                        <Border.Background>
                            <ImageBrush x:Name="CurrentAvatarBrush"
                                        ImageSource="/Assets/Avatar/default_avatar.png"
                                        Stretch="UniformToFill"/>
                        </Border.Background>
                    </Border>

                    <Button x:Name="ChangeAvatarButton"
                            Content="{x:Static props:Strings.ChangeAvatarButton}"
                            Style="{StaticResource OrangeButtonStyle}"
                            Width="250" Height="60"
                            FontSize="24" FontWeight="Bold"
                            Click="ChangeAvatarButton_Click"/>

                    <Border Background="#20000000" CornerRadius="10" Padding="20" Margin="0,40,0,0">
                        <StackPanel>
                            <TextBlock Text="{x:Static props:Strings.StatsTitle}" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{x:Static props:Strings.GamesPlayedLabel}" FontSize="20"/>
                                <TextBlock x:Name="GamesPlayedText" Text="0" FontSize="20" FontWeight="Bold" Grid.Column="1"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{x:Static props:Strings.GamesWonLabel}" FontSize="20"/>
                                <TextBlock x:Name="GamesWonText" Text="0" FontSize="20" FontWeight="Bold" Grid.Column="1" Foreground="#28A745"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{x:Static props:Strings.CoinsLabel}" FontSize="20"/>
                                <StackPanel Orientation="Horizontal" Grid.Column="1">
                                    <TextBlock Text="💰" FontSize="20" Margin="0,0,5,0"/>
                                    <TextBlock x:Name="CoinsText" Text="0" FontSize="20" FontWeight="Bold" Foreground="#D4AF37"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <ScrollViewer Grid.Row="1" Grid.Column="1" VerticalScrollBarVisibility="Hidden" Margin="60,0,0,0">
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="{x:Static props:Strings.UserProfilePageTitle}" FontSize="48" FontWeight="Bold" Foreground="#333" Margin="0,0,0,10"/>
                        <Separator Background="#CCC" Margin="0,0,0,40"/>

                        <TextBlock Text="{x:Static props:Strings.UsernameLabel}" FontSize="20" FontWeight="SemiBold" Foreground="#555"/>
                        <Grid Margin="0,0,0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="UsernameTextBox" Text="{x:Static props:Strings.LoadingText}" FontSize="24" Padding="10" Height="50" IsEnabled="False" Background="#EEE" Foreground="#888"/>
                            <Button x:Name="ChangeUsernameButton" Content="{x:Static props:Strings.ChangeButton}" Style="{StaticResource PrimaryButtonStyle}" Width="120" Height="50" Margin="10,0,0,0" Grid.Column="1" Click="ChangeUsernameButton_Click"/>
                        </Grid>
                        <TextBlock x:Name="UsernameInfoLabel" Visibility="Collapsed" FontSize="14" Margin="0,0,0,30"/>

                        <TextBlock Text="{x:Static props:Strings.EmailLabel}" FontSize="20" FontWeight="SemiBold" Foreground="#555"/>
                        <TextBox x:Name="EmailTextBox" Text="{x:Static props:Strings.LoadingText}" FontSize="24" Padding="10" Height="59" IsEnabled="False" Background="#EEE" Foreground="#888" Margin="0,0,0,30"/>

                        <Border Background="#10000000" CornerRadius="8" Padding="15" Margin="0,0,0,30">
                            <StackPanel>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{x:Static props:Strings.SocialNetworksTitle}" FontSize="20" FontWeight="Bold" Foreground="#444" VerticalAlignment="Center"/>
                                    <Button x:Name="AddSocialLinkButton" Content="+" Style="{StaticResource PrimaryButtonStyle}" Width="40" Height="40" FontSize="24" FontWeight="Bold" Padding="0,-2,0,0" Grid.Column="1" Click="AddSocialLinkButton_Click"/>
                                </Grid>

                                <ItemsControl x:Name="SocialLinksPanel">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="White" CornerRadius="5" Margin="0,0,0,8" Padding="10,5" BorderBrush="#DDD" BorderThickness="1">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="🔗" FontSize="18" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                    <TextBlock Grid.Column="1" VerticalAlignment="Center" FontSize="16">
                                                        <Hyperlink NavigateUri="{Binding Path=.}" RequestNavigate="Hyperlink_RequestNavigate">
                                                            <Run Text="{Binding Path=.}"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                                    <Button Grid.Column="2" Content="❌" Background="Transparent" BorderThickness="0" Foreground="#DC3545" FontWeight="Bold" FontSize="14" Cursor="Hand" Tag="{Binding Path=.}" Click="DeleteSocialLink_Click"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <Button x:Name="ChangePasswordButton"
                                Content="{x:Static props:Strings.ChangePasswordButton}"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Width="221" Height="47"
                                FontSize="20" FontWeight="Bold"
                                Margin="0,0,0,30"
                                HorizontalAlignment="Left"
                                Click="ChangePasswordButton_Click"/>

                        <Button x:Name="DeactivateAccountButton"
                                Content="{x:Static props:Strings.DeactivateAccountBtn}"
                                Background="#DC3545" Foreground="White"
                                Width="184" Height="44"
                                FontSize="18" FontWeight="Bold"
                                HorizontalAlignment="Left" Margin="0,0,0,30"
                                Cursor="Hand" Click="ShowDeactivatePopup_Click">
                            <Button.Resources>
                                <Style TargetType="Border">
                                    <Setter Property="CornerRadius" Value="8"/>
                                </Style>
                            </Button.Resources>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>

        <components:DeactivateAccountDialog x:Name="DeactivateDialog" Visibility="Collapsed" Panel.ZIndex="50"/>
        <components:AddSocialLinkDialog x:Name="AddLinkPopup" Visibility="Collapsed" Panel.ZIndex="50"/>

        <Border x:Name="DialogOverlay" Background="#B3000000" Visibility="Collapsed" Panel.ZIndex="1000">
            <Border Background="White" CornerRadius="20" Width="450" VerticalAlignment="Center" HorizontalAlignment="Center" Padding="30">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.5"/>
                </Border.Effect>
                <StackPanel>
                    <fa:ImageAwesome x:Name="DialogIcon" Icon="InfoCircle" Height="60" Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,20"/>
                    <TextBlock x:Name="DialogTitle" Text="Título" FontSize="28" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,10" TextAlignment="Center"/>
                    <TextBlock x:Name="DialogMessage" Text="Mensaje" FontSize="18" TextWrapping="Wrap" TextAlignment="Center" Foreground="#666" Margin="0,0,0,30"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition x:Name="CancelColumn" Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Button x:Name="ConfirmBtn" Content="Aceptar" Style="{StaticResource PrimaryButtonStyle}" Height="45" Margin="5" Click="DialogButton_Click"/>
                        <Button x:Name="CancelBtn" Grid.Column="1" Content="Cancelar" Style="{StaticResource OrangeButtonStyle}" Height="45" Margin="5" Click="DialogButton_Click" Visibility="Collapsed"/>
                    </Grid>
                </StackPanel>
            </Border>
        </Border>
    </Grid>
</Page>