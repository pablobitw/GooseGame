<Page x:Class="GameClient.Views.FriendshipPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:props="clr-namespace:GameClient.Resources"
      xmlns:fa="clr-namespace:FontAwesome.WPF;assembly=FontAwesome.WPF"
      mc:Ignorable="d" 
      d:DesignHeight="1080" d:DesignWidth="1920"
      Title="FriendshipPage"
      FontFamily="/Assets/Fonts/#Dosis">

    <Grid>
        <Grid.Background>
            <ImageBrush ImageSource="/Assets/fondo2.png" Stretch="UniformToFill" Opacity="1">
                <ImageBrush.Viewbox>
                    <Rect>0.2, 0.2, 0.6, 0.6</Rect>
                </ImageBrush.Viewbox>
            </ImageBrush>
        </Grid.Background>

        <Border Style="{StaticResource LobbyContainerBorderStyle}" Width="1000" Height="800">

            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="{x:Static props:Strings.FriendshipTitle}" 
                           FontSize="48" FontWeight="Bold" 
                           HorizontalAlignment="Left" VerticalAlignment="Center"
                           Margin="20,10,0,20"/>

                <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0">
                    <Border CornerRadius="15" Background="White" BorderBrush="#FFB0B0B0" BorderThickness="1" Height="45" Margin="0,0,10,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <fa:ImageAwesome Icon="Search" Foreground="Gray" Margin="10,0,5,0" VerticalAlignment="Center" Height="20"/>

                            <TextBox x:Name="SearchUserBox" Grid.Column="1" Width="250" FontSize="18" 
                                     VerticalContentAlignment="Center" BorderThickness="0" Background="Transparent"
                                     Tag="{x:Static props:Strings.SearchUserPlaceholder}"/>
                        </Grid>
                    </Border>

                    <Button x:Name="SendRequestButton" Content="{x:Static props:Strings.SendRequestButton}" 
                            Style="{StaticResource PrimaryButtonStyle}" Height="45" Width="160" 
                            FontSize="16" FontWeight="Bold" Click="SendFriendRequest_Click"/>
                </StackPanel>

                <TabControl Grid.Row="1" Background="Transparent" BorderThickness="0">
                    <TabControl.Resources>
                        <Style TargetType="TabItem">
                            <Setter Property="FontSize" Value="24"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="Padding" Value="20,10"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TabItem">
                                        <Border Name="Border" BorderThickness="0,0,0,3" BorderBrush="Transparent" Margin="5,0">
                                            <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header" Margin="10,2"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource PrimaryBrush}" />
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}" />
                                            </Trigger>
                                            <Trigger Property="IsSelected" Value="False">
                                                <Setter Property="Foreground" Value="Gray" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabControl.Resources>

                    <TabItem Header="{x:Static props:Strings.MyFriendsTab}">
                        <Grid>
                            <ListBox x:Name="FriendsListBox" Margin="20" Background="Transparent" BorderThickness="0" HorizontalContentAlignment="Stretch">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" CornerRadius="10" Padding="15" Margin="0,5">
                                            <Border.Effect>
                                                <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.1"/>
                                            </Border.Effect>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <fa:ImageAwesome Icon="UserCircle" Foreground="#555" Height="40" Width="40" VerticalAlignment="Center" Margin="0,0,15,0"/>

                                                <TextBlock Grid.Column="1" Text="{Binding Username}" FontSize="24" FontWeight="SemiBold" VerticalAlignment="Center"/>

                                                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,15,0">
                                                    <TextBlock Text="{Binding StatusText}" FontSize="16" Foreground="Gray" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                    <Ellipse Width="15" Height="15" Fill="{Binding StatusColorBrush}"/>
                                                </StackPanel>

                                                <Button Grid.Column="3" Style="{StaticResource OrangeButtonStyle}" 
                                                        Width="50" Height="40" 
                                                        ToolTip="{x:Static props:Strings.DeleteFriendToolTip}"
                                                        Tag="{Binding Username}" Click="DeleteFriend_Click">
                                                    <fa:ImageAwesome Icon="Trash" Foreground="White" Height="20"/>
                                                </Button>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <TextBlock x:Name="NoFriendsMessage" Text="{x:Static props:Strings.NoFriendsMessage}" FontSize="24" Foreground="Gray" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
                        </Grid>
                    </TabItem>

                    <TabItem>
                        <TabItem.Header>
                            <Grid>
                                <TextBlock Text="{x:Static props:Strings.RequestsTab}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <Border Background="Red" CornerRadius="10" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="10,-10,-15,0" MinWidth="22" Height="22" Visibility="{Binding RequestBadgeVisibility}">
                                    <TextBlock Text="{Binding RequestCount}" Foreground="White" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="4,0,4,2"/>
                                </Border>
                            </Grid>
                        </TabItem.Header>

                        <Grid>
                            <ListBox x:Name="FriendRequestsListBox" Margin="20" Background="Transparent" BorderThickness="0" HorizontalContentAlignment="Stretch">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" CornerRadius="10" Padding="15" Margin="0,5">
                                            <Border.Effect>
                                                <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.1"/>
                                            </Border.Effect>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <fa:ImageAwesome Icon="Envelope" Foreground="{StaticResource PrimaryBrush}" Height="30" Width="30" VerticalAlignment="Center" Margin="0,0,15,0"/>
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding Username}" FontSize="24" FontWeight="Bold"/>
                                                    <TextBlock Text="{x:Static props:Strings.RequestReceivedMessage}" FontSize="14" Foreground="Gray"/>
                                                </StackPanel>
                                                <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                    <Button Content="{x:Static props:Strings.AcceptButton}" Style="{StaticResource GreenButtonStyle}" Width="100" Height="40" FontSize="16" Margin="0,0,10,0" Tag="{Binding Username}" Click="AcceptRequest_Click"/>
                                                    <Button Content="{x:Static props:Strings.RejectButton}" Style="{StaticResource OrangeButtonStyle}" Width="100" Height="40" FontSize="16" Tag="{Binding Username}" Click="RejectRequest_Click"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <TextBlock x:Name="NoRequestsMessage" Text="{x:Static props:Strings.NoRequestsMessage}" FontSize="24" Foreground="Gray" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
                        </Grid>
                    </TabItem>

                    <TabItem Header="Enviadas">
                        <Grid>
                            <ListBox x:Name="SentRequestsListBox" Margin="20" Background="Transparent" BorderThickness="0" HorizontalContentAlignment="Stretch">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" CornerRadius="10" Padding="15" Margin="0,5">
                                            <Border.Effect>
                                                <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.1"/>
                                            </Border.Effect>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <fa:ImageAwesome Icon="PaperPlane" Foreground="Gray" Height="25" Width="25" VerticalAlignment="Center" Margin="0,0,15,0"/>

                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding Username}" FontSize="24" FontWeight="Bold"/>
                                                    <TextBlock Text="Esperando respuesta..." FontSize="14" Foreground="Gray" FontStyle="Italic"/>
                                                </StackPanel>

                                                <Button Grid.Column="2" Content="Cancelar" Style="{StaticResource OrangeButtonStyle}" 
                                                        Width="120" Height="40" FontSize="16" 
                                                        Tag="{Binding Username}" Click="CancelSentRequest_Click"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <TextBlock x:Name="NoSentRequestsMessage" Text="No has enviado solicitudes pendientes" FontSize="24" Foreground="Gray" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
                        </Grid>
                    </TabItem>
                </TabControl>
            </Grid>
        </Border>

        <Button x:Name="BackButton" Content="{x:Static props:Strings.BackButton}" 
                Style="{StaticResource PrimaryButtonStyle}" 
                FontFamily="/Assets/Fonts/#Dosis" FontSize="24" FontWeight="Bold"
                HorizontalAlignment="Left" VerticalAlignment="Top" 
                Margin="20" Width="100" Height="50"
                Click="BackButton_Click"/>

    </Grid>
</Page>